{% extends 'base.html' %}

{% block title %}Edit {{ child.name if child.name else child[1] }} - BabyGrow{% endblock %}

{% block content %}
<div class="container animate-fadeIn">
    <div style="max-width: 600px; margin: 0 auto;">
        {% set child_id = child.id if child.id else child[0] %}
        {% set child_name = child.name if child.name else child[1] %}
        {% set child_dob = child.dob if child.dob else child[2] %}
        {% set child_gender = child.gender if child.gender else child[3] %}
        
        <a href="{{ url_for('children') }}" class="text-muted" style="display: inline-flex; align-items: center; gap: var(--space-xs); margin-bottom: var(--space-md);">
            <i class="bi bi-arrow-left"></i> Kembali
        </a>
        <h1>Edit Data Anak ‚úèÔ∏è</h1>
        <p class="text-muted" style="margin-bottom: var(--space-xl)">Update informasi {{ child_name }}</p>
        
        <div class="card">
            <form method="POST">
                <div class="form-group">
                    <label class="form-label">Nama Anak *</label>
                    <input type="text" name="name" class="form-input" value="{{ child_name }}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tanggal Lahir *</label>
                    <input type="date" name="dob" class="form-input" value="{{ child_dob }}" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Jenis Kelamin</label>
                    <div class="gender-selector">
                        <label class="gender-option {{ 'selected' if child_gender == 'Laki-laki' }}" id="gender-male" onclick="selectGender('male')">
                            <input type="radio" name="gender" value="Laki-laki" {{ 'checked' if child_gender == 'Laki-laki' }}>
                            <div class="gender-icon">üë¶</div>
                            <div>Laki-laki</div>
                        </label>
                        <label class="gender-option {{ 'selected' if child_gender == 'Perempuan' }}" id="gender-female" onclick="selectGender('female')">
                            <input type="radio" name="gender" value="Perempuan" {{ 'checked' if child_gender == 'Perempuan' }}>
                            <div class="gender-icon">üëß</div>
                            <div>Perempuan</div>
                        </label>
                    </div>
                </div>
                
                <div class="flex gap-md" style="margin-top: var(--space-xl);">
                    <button type="submit" class="btn btn-primary btn-lg" style="flex: 1;">
                        <i class="bi bi-check-circle"></i> Simpan
                    </button>
                    <a href="{{ url_for('children') }}" class="btn btn-ghost btn-lg">Batal</a>
                </div>
            </form>
        </div>
        
        <!-- Delete Button -->
        <div class="card" style="margin-top: var(--space-lg); border-left: 4px solid var(--color-error);">
            <h3 style="color: var(--color-error);">‚ö†Ô∏è Zona Bahaya</h3>
            <p class="text-muted">Menghapus data anak akan menghapus semua data terkait termasuk pertumbuhan, milestone, dan imunisasi.</p>
            <form method="POST" action="{{ url_for('delete_child', child_id=child_id) }}" 
                  onsubmit="return confirm('Yakin ingin menghapus data {{ child_name }}? Semua data terkait akan ikut terhapus.');">
                <button type="submit" class="btn" style="background: rgba(239, 118, 122, 0.1); color: var(--color-error); border: 1px solid var(--color-error);">
                    <i class="bi bi-trash"></i> Hapus Data Anak
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function selectGender(gender) {
    document.querySelectorAll('.gender-option').forEach(el => el.classList.remove('selected'));
    document.getElementById('gender-' + gender).classList.add('selected');
}
</script>
{% endblock %}
